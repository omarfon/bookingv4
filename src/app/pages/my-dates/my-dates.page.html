<ion-header>
  <ion-toolbar color="tertiary" hideBackButton="true">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title> Mi citas </ion-title>
    <ion-buttons slot="end">
      <!--  <ion-button (click)="openVideo()">
        <ion-icon name="videocam" color="danger"></ion-icon>
      </ion-button> -->
    </ion-buttons>
  </ion-toolbar>
  <ion-toolbar color="tertiary">
    <ion-segment scrollable [(ngModel)]="citas" color="secondary">
      <ion-segment-button value="miscitas">
        <label>Proximas citas</label>
      </ion-segment-button>
      <ion-segment-button value="citaspasadas">
        <label>Citas Pasadas</label>
      </ion-segment-button>
      <!-- <ion-segment-button value="citasfamiliares">
        <p>citas familiares</p>
      </ion-segment-button> -->
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div [ngSwitch]="citas">
    <div *ngSwitchCase="'miscitas'">
      <ion-list *ngFor='let task of tasks'>
        <ion-card class="bordeDerecho" *ngIf="task; else notasks">
          <ion-row class="nopadding">
            <ion-col size="4">
              <ion-avatar item-start>
                <img src="{{SERVERImage}}{{task.professionalId}}.png" (error)="errorHandler($event)">
              </ion-avatar>
            </ion-col>
            <ion-col size="8" (click)="goToDetailsTask(task)">
              <ion-col size="12" class="nombrePrincipalBox">
                <p>Cita para: {{nombre}}</p>
              </ion-col>
              <h3 class="tituloCitas" text-wrap>{{task.professionalName}} {{task.professionalLastName1}}
                {{task.professionalLastName2}}</h3>
              <p class="especialidad" text-wrap> <span>Especialidad:</span>
                {{ task.basicServiceDescription | lowercase }}</p>
              <p class="sede" *ngIf="task.provisionDescription !== 'TELEORIENTACION'">Sede:
                {{ task.centerName | lowercase }}</p>
              <p class="sede" *ngIf="task.provisionDescription === 'TELEORIENTACION'">TELECONSULTA</p>
            </ion-col>
            <ion-col size="12" class="gris">
              <ion-row>
                <ion-col size="9" class="diaCita">
                  <p class="day">{{ task.appointmentDateTime | date:'d MMMM ' : 'es-ES' }} </p>
                </ion-col>
                <ion-col size="3" class="hourCita">
                  <p class="hour">{{ task.appointmentDateTime | date: 'HH:mm' }}</p>
                </ion-col>
              </ion-row>

            </ion-col>
          </ion-row>
        </ion-card>
      </ion-list>
      <div>
        <div *ngIf="conCitas">
          <div *ngFor="let citas of conCitas">
            <ion-list *ngFor='let task of citas.appointments'>
              <ion-card class="bordeDerecho">
                <ion-row class="nopadding">
                  <ion-col size="4">
                    <ion-avatar item-start>
                      <img src="{{SERVERImage}}{{task.professionalId}}.png" (error)="errorHandler($event)">
                    </ion-avatar>
                  </ion-col>
                  <ion-col size="8" (click)="gotoDetails(task)">
                    <ion-row>
                      <ion-col size="12" class="nombreFamiliarBox">
                        <p class="nombreFamiliar">Cita para: {{task.patientName}}</p>
                      </ion-col>
                      <ion-col size="12">
                        <h3 class="tituloCitas" text-wrap>
                          {{task.professionalName}} {{task.professionalLastName1}} {{task.professionalLastName2}}</h3>
                        <p class="especialidad">{{ task.basicServiceDescription | lowercase }}
                        </p>
                        <p class="sede" *ngIf="task.provisionDescription !== 'TELEORIENTACION'">
                          {{ task.centerName | lowercase }}</p>
                        <p class="sede" *ngIf="task.provisionDescription === 'TELEORIENTACION'">TELECONSULTA</p>
                      </ion-col>
                    </ion-row>
                  </ion-col>
                  <ion-col size="12" class="gris">
                    <ion-row>
                      <ion-col size="9" class="diaCita">
                        <p class="day">{{ task.appointmentDateTime | date:'d MMMM ' : 'es-ES' }} </p>
                      </ion-col>
                      <ion-col size="3" class="hourCita">
                        <p class="hour">{{ task.appointmentDateTime | date: 'HH:mm' }}</p>
                      </ion-col>
                    </ion-row>
                  </ion-col>
                </ion-row>
              </ion-card>
            </ion-list>
          </div>
        </div>
      </div>
      <div *ngIf="conCitas < 1 && tasks.length < 1" class="contenedorSinCitas">
        <!--  <div class="imagenSinCitas">
          <img src="assets/imgs/sinCitas.png" alt="">
        </div> -->
        <p class="textoCitasNulo">No tienes citas pendientes</p>
      </div>
    </div>

    <div *ngSwitchCase="'citaspasadas'">
      <ion-slides class="containerDepends">
        <ion-slide>
          <div class="row">
            <ion-col size="12">
              <div class="botonConImagen" (click)="getDatesUser()">
                <p>{{nombreCortado}}</p>
              </div>
            </ion-col>
            <ion-col size="12">
              <p class="principalName">{{nombre}}</p>
            </ion-col>
          </div>
        </ion-slide>

        <ion-slide *ngFor="let dep of dependens">
          <div class="row">
            <ion-col>
              <div color="secondary" class="botonConImagenParent" (click)="getDatesDepends(dep)">
                <p>{{dep.name | slice:0:1}}</p>
              </div>
            </ion-col>
            <ion-col>
              <p class="nombreUsuarios">{{dep.name}}</p>
            </ion-col>
          </div>
        </ion-slide>
      </ion-slides>
      <ion-list *ngFor='let citaspa of citaspasadas'>
        <ion-card class="bordeDerecho" *ngIf="citaspasadas ">
          <ion-row class="nopadding">
            <ion-col size="4">
              <ion-avatar item-start>
                <img src="{{SERVERImage}}{{citaspa.codigo_personal}}.png" (error)="errorHandler($event)">

              </ion-avatar>
            </ion-col>
            <ion-col size="8">
              <h3 class="tituloCitasPasadas" text-wrap>{{citaspa.apellido1 | lowercase}}
                {{citaspa.apellido2 | lowercase}}
                {{citaspa.nombre | lowercase}}</h3>
              <p class="especialidad" text-wrap>CMP: {{ citaspa.codigo_colegiado | lowercase }}</p>
              <p class="especialidad" text-wrap>{{ citaspa.servicio_basico | lowercase }}</p>
              <p class="sede">Sede: {{ citaspa.nombre_centro | lowercase }}</p>
            </ion-col>
            <ion-grid>
              <!--     <ion-row *ngIf="citaspa.tiene_receta == 1">
                <ion-col size="10" class="centrado">
                  <p>receta para esta cita:</p>
                </ion-col>
                <ion-col size="2">
                  <ion-button clear class="iconoDerecha" (click)="goToRecipe(citaspa)">
                    <ion-icon name="attach">
                    </ion-icon>
                  </ion-button>
                </ion-col>
              </ion-row> -->
            </ion-grid>
            <ion-col size="12" class="gris">
              <ion-row>
                <ion-col class="diaCita">
                  <p class="day">{{ citaspa.date | slice:0:10 | date:'d MMMM ' : 'es' }} </p>
                </ion-col>
                <ion-col class="hourCita">
                  <p class="hour">{{ citaspa.hora | slice:11:16}}</p>
                </ion-col>
              </ion-row>
            </ion-col>
          </ion-row>
        </ion-card>
        <div *ngIf="!citaspasadas.encuentros && !citaspasadas">
          <p class="textoCitasNulo">No tienes citas pasadas</p>
        </div>
      </ion-list>
    </div>

  </div>


</ion-content>